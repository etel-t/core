###################################################################
# Local syslog-ng configuration filter definition [wireless].
###################################################################
filter f_local_wireless {
    program("hostapd");
};   
destination d_local_wireless {
    file(
        "/var/log/wireless/wireless_${YEAR}${MONTH}${DAY}.log"
        create-dirs(yes)
        flags(syslog-protocol)
    );
};
log {
    source(s_all);
    filter(f_local_wireless);
    destination(d_local_wireless);
};

###################################################################
# Local syslog-ng configuration filter definition [vpn].
###################################################################
filter f_local_vpn {
    facility(local3);
};   
destination d_local_vpn {
    file(
        "/var/log/vpn/vpn_${YEAR}${MONTH}${DAY}.log"
        create-dirs(yes)
        flags(syslog-protocol)
    );
};
log {
    source(s_all);
    filter(f_local_vpn);
    destination(d_local_vpn);
};

###################################################################
# Local syslog-ng configuration filter definition [suricata].
###################################################################
filter f_local_suricata {
    program("suricata");
};   
destination d_local_suricata {
    file(
        "/var/log/suricata/suricata_${YEAR}${MONTH}${DAY}.log"
        create-dirs(yes)
        flags(syslog-protocol)
    );
};
log {
    source(s_all);
    filter(f_local_suricata);
    destination(d_local_suricata);
};

###################################################################
# Local syslog-ng configuration filter definition [squid_access].
###################################################################
filter f_local_squid_access {
    program("(squid-1)");
};   
destination d_local_squid_access {
    file(
        "/var/log/squid/access/access_${YEAR}${MONTH}${DAY}.log"
        create-dirs(yes)
        flags(syslog-protocol)
    );
};
log {
    source(s_all);
    filter(f_local_squid_access);
    destination(d_local_squid_access);
};

###################################################################
# Local syslog-ng configuration filter definition [routing].
###################################################################
filter f_local_routing {
    program("radvd") or
    program("routed") or
    program("rtsold") or
    program("olsrd") or
    program("zebra") or
    program("ospfd") or
    program("bgpd") or
    program("miniupnpd");
};   
destination d_local_routing {
    file(
        "/var/log/routing/routing_${YEAR}${MONTH}${DAY}.log"
        create-dirs(yes)
        flags(syslog-protocol)
    );
};
log {
    source(s_all);
    filter(f_local_routing);
    destination(d_local_routing);
};

###################################################################
# Local syslog-ng configuration filter definition [resolver].
###################################################################
filter f_local_resolver {
    program("unbound");
};   
destination d_local_resolver {
    file(
        "/var/log/resolver/resolver_${YEAR}${MONTH}${DAY}.log"
        create-dirs(yes)
        flags(syslog-protocol)
    );
};
log {
    source(s_all);
    filter(f_local_resolver);
    destination(d_local_resolver);
};

###################################################################
# Local syslog-ng configuration filter definition [ppps].
###################################################################
filter f_local_ppps {
    program("ppp");
};   
destination d_local_ppps {
    file(
        "/var/log/ppps/ppps_${YEAR}${MONTH}${DAY}.log"
        create-dirs(yes)
        flags(syslog-protocol)
    );
};
log {
    source(s_all);
    filter(f_local_ppps);
    destination(d_local_ppps);
};

###################################################################
# Local syslog-ng configuration filter definition [portalauth].
###################################################################
filter f_local_portalauth {
    facility(local4) or program("captiveportal");
};   
destination d_local_portalauth {
    file(
        "/var/log/portalauth/portalauth_${YEAR}${MONTH}${DAY}.log"
        create-dirs(yes)
        flags(syslog-protocol)
    );
};
log {
    source(s_all);
    filter(f_local_portalauth);
    destination(d_local_portalauth);
};

###################################################################
# Local syslog-ng configuration filter definition [pkg].
###################################################################
filter f_local_pkg {
    program("pkg") or program("pkg-static");
};   
destination d_local_pkg {
    file(
        "/var/log/pkg/pkg_${YEAR}${MONTH}${DAY}.log"
        create-dirs(yes)
        flags(syslog-protocol)
    );
};
log {
    source(s_all);
    filter(f_local_pkg);
    destination(d_local_pkg);
};

###################################################################
# Local syslog-ng configuration filter definition [openvpn].
###################################################################
filter f_local_openvpn {
    program("openvpn");
};   
destination d_local_openvpn {
    file(
        "/var/log/openvpn/openvpn_${YEAR}${MONTH}${DAY}.log"
        create-dirs(yes)
        flags(syslog-protocol)
    );
};
log {
    source(s_all);
    filter(f_local_openvpn);
    destination(d_local_openvpn);
};

###################################################################
# Local syslog-ng configuration filter definition [ntpd].
###################################################################
filter f_local_ntpd {
    program("ntp") or program("ntpd") or program("ntpdate");
};   
destination d_local_ntpd {
    file(
        "/var/log/ntpd/ntpd_${YEAR}${MONTH}${DAY}.log"
        create-dirs(yes)
        flags(syslog-protocol)
    );
};
log {
    source(s_all);
    filter(f_local_ntpd);
    destination(d_local_ntpd);
};

###################################################################
# Local syslog-ng configuration filter definition [monit].
###################################################################
filter f_local_monit {
    program("monit");
};   
destination d_local_monit {
    file(
        "/var/log/monit/monit_${YEAR}${MONTH}${DAY}.log"
        create-dirs(yes)
        flags(syslog-protocol)
    );
};
log {
    source(s_all);
    filter(f_local_monit);
    destination(d_local_monit);
};

###################################################################
# Local syslog-ng configuration filter definition [lighttpd].
###################################################################
filter f_local_lighttpd {
    program("lighttpd");
};   
destination d_local_lighttpd {
    file(
        "/var/log/lighttpd/lighttpd_${YEAR}${MONTH}${DAY}.log"
        create-dirs(yes)
        flags(syslog-protocol)
    );
};
log {
    source(s_all);
    filter(f_local_lighttpd);
    destination(d_local_lighttpd);
};

###################################################################
# Local syslog-ng configuration filter definition [ipsec].
###################################################################
filter f_local_ipsec {
    program("charon");
};   
destination d_local_ipsec {
    file(
        "/var/log/ipsec/ipsec_${YEAR}${MONTH}${DAY}.log"
        create-dirs(yes)
        flags(syslog-protocol)
    );
};
log {
    source(s_all);
    filter(f_local_ipsec);
    destination(d_local_ipsec);
};

###################################################################
# Local syslog-ng configuration filter definition [gateways].
###################################################################
filter f_local_gateways {
    program("dpinger");
};   
destination d_local_gateways {
    file(
        "/var/log/gateways/gateways_${YEAR}${MONTH}${DAY}.log"
        create-dirs(yes)
        flags(syslog-protocol)
    );
};
log {
    source(s_all);
    filter(f_local_gateways);
    destination(d_local_gateways);
};

###################################################################
# Local syslog-ng configuration firewall definition [firewall].
###################################################################
filter f_local_firewall {
  program("firewall");
};   
destination d_local_firewall {
    file(
        "/var/log/firewall/firewall_${YEAR}${MONTH}${DAY}.log"
        create-dirs(yes)
        flags(syslog-protocol)
    );
};
log {
    source(s_all);
    filter(f_local_firewall);
    destination(d_local_firewall);
};

###################################################################
# Local syslog-ng configuration filter definition [filter].
###################################################################
filter f_local_filter {
    program("filterlog");
};   
destination d_local_filter {
    file(
        "/var/log/filter/filter_${YEAR}${MONTH}${DAY}.log"
        create-dirs(yes)
        flags(syslog-protocol)
    );
};
log {
    source(s_all);
    filter(f_local_filter);
    destination(d_local_filter);
};

###################################################################
# Local syslog-ng configuration filter definition [dnsmasq].
###################################################################
filter f_local_dnsmasq {
    program("dnsmasq");
};   
destination d_local_dnsmasq {
    file(
        "/var/log/dnsmasq/dnsmasq_${YEAR}${MONTH}${DAY}.log"
        create-dirs(yes)
        flags(syslog-protocol)
    );
};
log {
    source(s_all);
    filter(f_local_dnsmasq);
    destination(d_local_dnsmasq);
};

###################################################################
# Local syslog-ng configuration filter definition [dhcpd].
###################################################################
filter f_local_dhcpd {
    facility(local7) or program("dhcpd") or program("dhcrelay");
};   
destination d_local_dhcpd {
    file(
        "/var/log/dhcpd/dhcpd_${YEAR}${MONTH}${DAY}.log"
        create-dirs(yes)
        flags(syslog-protocol)
    );
};
log {
    source(s_all);
    filter(f_local_dhcpd);
    destination(d_local_dhcpd);
};

###################################################################
# Local syslog-ng configuration filter definition [configd].
###################################################################
filter f_local_configd {
    program("configd.py");
};   
destination d_local_configd {
    file(
        "/var/log/configd/configd_${YEAR}${MONTH}${DAY}.log"
        create-dirs(yes)
        flags(syslog-protocol)
    );
};
log {
    source(s_all);
    filter(f_local_configd);
    destination(d_local_configd);
};

###################################################################
# Local syslog-ng configuration filter definition [audit].
###################################################################
filter f_local_audit {
    program("audit") or facility(auth);
};   
destination d_local_audit {
    file(
        "/var/log/audit/audit_${YEAR}${MONTH}${DAY}.log"
        create-dirs(yes)
        flags(syslog-protocol)
    );
};
log {
    source(s_all);
    filter(f_local_audit);
    destination(d_local_audit);
};

###################################################################
# Local syslog-ng configuration filter definition [acmeclient].
###################################################################
filter f_local_acmeclient {
    program("acme.sh");
};   
destination d_local_acmeclient {
    file(
        "/var/log/acmeclient/acmeclient_${YEAR}${MONTH}${DAY}.log"
        create-dirs(yes)
        flags(syslog-protocol)
    );
};
log {
    source(s_all);
    filter(f_local_acmeclient);
    destination(d_local_acmeclient);
};


################################################################################
# not captured elsewhere, but relevant, send to system[__].log
################################################################################
filter f_local_system {
    not filter(f_local_wireless) and not filter(f_local_vpn) and not filter(f_local_suricata) and not filter(f_local_squid_access) and not filter(f_local_routing) and not filter(f_local_resolver) and not filter(f_local_ppps) and not filter(f_local_portalauth) and not filter(f_local_pkg) and not filter(f_local_openvpn) and not filter(f_local_ntpd) and not filter(f_local_monit) and not filter(f_local_lighttpd) and not filter(f_local_ipsec) and not filter(f_local_gateways) and not filter(f_local_firewall) and not filter(f_local_filter) and not filter(f_local_dnsmasq) and not filter(f_local_dhcpd) and not filter(f_local_configd) and not filter(f_local_audit) and not filter(f_local_acmeclient)
    and level(notice..emerg)
};

destination d_local_system {
    file(
        "/var/log/system/system_${YEAR}${MONTH}${DAY}.log"
        create-dirs(yes)
        flags(syslog-protocol)
    );
};

log {
    source(s_all);
    filter(f_local_system);
    destination(d_local_system);
};

