db.conn_all.aggregate([{"$match":{"start_time":{"$gt":___START_TIME___,"$lt": ___END_TIME___}}},{"$project":{"src_hostname": {"$cond": { "if": { "$eq": [ "$src_dir", "INGRESS" ] }, "then": "$src_hostname", "else": "$dst_hostname" }}__PCOLUMN__}},{"$group":{"_id":{"label":"$src_hostname"},"total":{"$sum":"___SUM_FIELD___"}}},{"$sort":{"total":-1}},{"$limit":10}])