[service]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/control_service.sh
parameters:%s %s
type:script_output
message:control services

[engine-version]
command:/usr/local/sensei/bin/eastpect -V | grep -i "release" | cut -d" " -f2
parameters:
type:script_output
message:check zenarmor version

[engine-date]
command:date -r /usr/local/sensei/bin/eastpect
parameters:
type:script_output
message:check zenarmor last modified

[ui-version]
command:pkg info os-sensei 2>/dev/null | grep -iv freebsd | grep -i version | cut -d":" -f2 | tr -d '[:space:]'
parameters:
type:script_output
message:check zenarmor ui version

[db-version]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/sensei-db-version.sh
parameters:
type:script_output
message:check zenarmor db version

[db-date]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/sensei-db-version.sh date
parameters:
type:script_output
message:check zenarmor db last modified

[stats-read]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/read_stats.sh
parameters:
type:script_output
# message:read sensei stats

[nodes-status]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/nodes_status.py
parameters:--mode %s
type:script_output
message:check zenarmor cloud nodes status

[check-updates]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/check_updates.sh
parameters:%s
type:script_output
message:check zenarmor updates
description:Check zenarmor updates

[update-install]
command:/usr/sbin/daemon -o /tmp/zenarmor_update.progress -P /tmp/sensei_update.pid /usr/local/opnsense/scripts/OPNsense/Sensei/install_update.sh
parameters:%s %s
type:script
message: install %s update

[update-status]
command:/usr/bin/touch /tmp/zenarmor_update.progress 2>&1;/usr/bin/touch /tmp/sensei_update.progress 2>&1; /bin/cat /tmp/zenarmor_update.progress 2>&1; /bin/cat /tmp/sensei_update.progress 2>&1
parameters:
type:script_output
message:retrieve update progress status

[cpu-count]
command:sysctl hw | grep "hw.ncpu" | sed "s/ //g" | cut -d":" -f2
parameters:
type:script_output
message:cpu count

[check-health]
command:/usr/local/sensei/scripts/health/opnsense/18.1/check_health.sh
parameters:
type:script
message:check zenarmor engine health
description:Check zenarmor packet engine health

[log-delete]
command:/usr/local/sensei/scripts/health/opnsense/18.1/log_delete.sh
parameters:
type:script
message:delete zenarmor log files with retire

[datastore-retire]
command:/usr/local/sensei/scripts/datastore/retire.sh
parameters:%s
type:script
message:datastore retire
description:Zenarmor datastore retire

[datastore-delete]
command:/usr/local/sensei/scripts/datastore/delete-data-interval.sh
parameters:%s %s
type:script_output
message:erase reporting data older than %s day.

[delete-ip]
command:/usr/local/sensei/scripts/datastore/delete-data-ip.sh
parameters:
type:script_output
message:Delete ip from report database


[datastore-path]
command:/usr/local/sensei/scripts/datastore/get-db-path.sh
parameters:%s
type:script_output
message:Get Database Path

[database-disk-size]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/check_db_disksize.sh
parameters:%s
type:script_output
message:view database disk size

[elasticsearch-disk-size]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/check_es_disksize.sh
parameters:
type:script_output
message:view elasticsearch disk size

[backup]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/backup.sh
parameters:%s
type:script_output
message:Sensei backup

[restore]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/restore.sh
parameters:%s %s %s %s %s
type:script_output
message:Sensei restore

[restore-db]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/restore-db.sh
parameters:%s %s
type:script_output
message:Sensei restore db rules


[restore-db-rules]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/restore-rules.sh
parameters:%s %s
type:script_output
message:Sensei restore db rules

[restore-db-copy]
command:cp 
parameters:%s %s
type:script_output
message:Sensei restore db rules


[elasticsearch-delete-data-folder]
command:/usr/local/sensei/scripts/installers/elasticsearch/delete_data_folder.sh
parameters:
type:script_output
message:deleting elasticsearch data folder

[mongodb-repair]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/mongodb-repair.sh
parameters:
type:script_output
message:deleting elasticsearch data folder


[delete-data-folder]
command:/usr/local/sensei/scripts/datastore/delete-data-folder.sh
parameters:%s
type:script_output
message:deleting database data folder

[aliases]
command:/usr/local/bin/php /usr/local/opnsense/mvc/app/models/OPNsense/Sensei/Aliases.php
parameters:
type:script_output
message:Aliases recognize

[onboot]
command:/usr/local/bin/php /usr/local/opnsense/mvc/app/models/OPNsense/Sensei/CLI.php onboot
parameters:%s
type:script_output
message:change sensei auto-start configuration

[mail-test]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/report-gen/send.py
parameters:--pdf %s --server %s --port %s --secured %s --username %s --password %s --sender %s --to %s --nosslverify %s
type:script_output
message:test sensei mail configuration

[mail-reports]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/report-gen/send.py
parameters:
type:script
message:send sensei scheduled reports to email
description:Sensei email scheduled reports

[reset]
command:/usr/local/bin/php /usr/local/opnsense/mvc/app/models/OPNsense/Sensei/CLI.php reset
parameters:
type:script_output
message:reset sensei configuration

[setadmode]
command:/usr/local/bin/php /usr/local/opnsense/mvc/app/models/OPNsense/Sensei/CLI.php sysctl
parameters:%s
type:script_output
message:change kernel dev.netmap.admode for generic driver of netmap %s

[init]
command:/bin/sh /usr/local/sensei/scripts/installers/opnsense/18.1/sensei-init.sh 2>&1 | /usr/bin/tee /tmp/sensei_init.log
parameters: %s
type:script_output
message:run sensei init script

[whois]
command:/usr/bin/whois
parameters:%s
type:script_output
message:query whois record

[hostname]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/dns_reverse.py
parameters:-i %s -S %s
type:script_output
message:query hostname for ip address

[uninstall]
command:/usr/sbin/daemon -o /tmp/sensei_uninstall.log -P /tmp/sensei_uninstall.pid /usr/local/opnsense/scripts/OPNsense/Sensei/uninstall_engine.sh
parameters:-d %s -f %s
type:script
message:uninstall application

[license]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/check_license.sh
parameters:
type:script_output
message:view license

[license-verify]
command:/usr/local/sensei/bin/eastpect -x /tmp/sensei-license.data || exit 0
parameters:
type:script_output
message:verify license

[license-details]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/check_license.py
parameters:
type:script_output
message:license details

[license-check]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/check_license_expire.py
parameters:
type:script_output
message:license details

[hardware]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/check_hardware.sh
parameters:
type:script_output
message:check hardware

[reinstall.elasticsearch]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/reinstall_elasticsearch.sh
parameters:%s %s
type:script_output
message:reinstall elasticsearch

[reinstall.mongodb]
command: /usr/sbin/daemon -f /usr/local/opnsense/scripts/OPNsense/Sensei/reinstall_mongodb.sh
parameters:%s %s
type:script_output
message:reinstall mongodb

[reinstall.sqlite]
command: /usr/sbin/daemon -f /usr/local/opnsense/scripts/OPNsense/Sensei/reinstall_sqlite.sh
parameters:%s %s
type:script_output
message:reinstall sqlite

[reinstall.sensei-agent]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/reinstall_cloud_agent.sh &
parameters:
type:script_output
message:reinstall sensei cloud agent

[checkinstall.sensei-agent]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/check_install_cloud_agent.sh &
parameters:
type:script_output
message:checkinstall sensei cloud agent


[restart-ipdrstreamer]
command: /usr/local/opnsense/scripts/OPNsense/Sensei/restart_ipdr.sh
parameters:
type:script_output
message:restart ipdrstreamer


[erase-reporting-data]
command:/usr/local/sensei/scripts/datastore/delete-data-interval.sh
parameters:%s %s
type:script_output
message:erase reporting data

[change-data-path]
command:/usr/local/sensei/scripts/datastore/change-data-path.sh
parameters:%s %s %s
type:script_output
message:Change DB Path

[reporting-index-create]
command:/usr/local/sensei/scripts/installers/elasticsearch/create_indices.py
parameters:%s %s
type:script_output
message:create index


[reindex.elasticsearch]
command:/usr/local/sensei/scripts/installers/elasticsearch/recreate_indices.py
parameters:%s
type:script_output
message:reindex %s on elasticsearch

[policy.reload]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/policy/policy_template.py
parameters:
type:script_output
message:policy reload

[worker.reload]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/worker_template.py
parameters:
type:script_output
message:workers reload

[application.reload]
command:/usr/local/sensei/scripts/installers/opnsense/18.1/load_policy_categories.py
parameters:
type:script_output
message:application reload

[bypass]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/check_bypass.sh
parameters:%s
type:script_output
message:Checking Hardware Bypass State

[periodicals]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/periodicals.sh
parameters:
type:script_output
description:Sensei periodicals
message:Runing periodical scripts

[heartbeat]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/heartbeat.sh
parameters:
type:script_output
description:Sensei heardbeat
message:Sensei heardbeat

[numberofdevice]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/numberofdevice.py
parameters:
type:script_output
description:Sensei Number of devices
message:Sensei Number of devices

[userenrich]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/userenrich.py
parameters:
type:script_output
message:captive login logout enrich

[userenrich-expire]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/userenrich-expire.sh
parameters:
type:script_output
message:captive login logout enrich deleted of record expired

[backup-temp-folder]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/mount_tmpfs.sh backup
parameters:
type:script_output
message:Backup temp folder

[restore-temp-folder]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/mount_tmpfs.sh restore
parameters:
type:script_output
message:restore temp folder

[change-size-temp-folder]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/mount_tmpfs.sh changesize 
parameters:%s
type:script_output
message:Backup temp folder

[cloud-sighup]
command:/usr/local/opnsense/scripts/OPNsense/Sensei/cloud_sighup.sh
parameters:%s
type:script_output
message:Cloud agent send singup signal

[migrate-settings]
command:/usr/local/sensei/scripts/database/migrate.py 
parameters:
type:script_output
message:migrate settings database

[set-interface]
command:/usr/local/bin/php /usr/local/opnsense/mvc/app/models/OPNsense/Sensei/CLI.php setinterface
parameters:%s
type:script_output
message: interface settings for iso
